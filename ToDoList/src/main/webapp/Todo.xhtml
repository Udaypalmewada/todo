<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Insert title here</title>
<link type="text/css" rel="stylesheet" href="resources/css/mystyle.css" />
</h:head>
<h:body>
	<h3>Todo list v1.2</h3>
	<f:view>
		<h:messages layout="table"></h:messages>

		<h:form>
			<h:commandButton binding="#{todoController.addCommand}" accesskey="n"
				action="#{todoController.addNew}" value="Add new Todo">
			</h:commandButton>
		</h:form>


		<h:form binding="#{todoController.form}" rendered="false"
			styleClass="todo">
			<h:panelGrid columns="2">
				<h:outputText value="Title"></h:outputText>
				<h:inputText value="#{todoController.todo.title}" required="true"
					requiredMessage="Title is required">
				</h:inputText>
				<h:outputText value="Description"></h:outputText>
				<h:inputTextarea value="#{todoController.todo.description}"
					cols="40" rows="4"></h:inputTextarea>
				<h:outputText value="Prio"></h:outputText>
				<h:selectOneMenu validatorMessage="required"
					value="#{todoController.todo.priority}">
					<f:selectItems value="#{todoController.priorities}" />
				</h:selectOneMenu>
			</h:panelGrid>
			<h:panelGroup>
				<h:commandButton action="#{todoController.save}" value="Save"
					accesskey="s">
				</h:commandButton>
				<h:commandButton action="#{todoController.cancel}" value="Cancel"
					accesskey="c" immediate="true">
				</h:commandButton>
			</h:panelGroup>
		</h:form>

		<h:form>
			<h:panelGrid columns="2">
				<h:commandButton id="hide"
					actionListener="#{todoController.displayTable}" value="Hide Table">
				</h:commandButton>
				<h:commandButton id="show"
					actionListener="#{todoController.displayTable}" value="Show Table">
				</h:commandButton>
			</h:panelGrid>
		</h:form>

		<h:form binding="#{todoController.tableForm}">

			<h:dataTable value="#{todoController.todos}" var="todo"
				styleClass="todo" headerClass="todoheader"
				columnClasses="first, rest">
				<h:column>
					<f:facet name="header">
						<h:column>
							<h:outputText value="Prio"></h:outputText>
						</h:column>
					</f:facet>
					<h:outputText value="#{todo.priority}"
						binding="#{todoController.selectPriorityOut}" for="priority"
						rendered="#{todo.id != todoController.selectedId}"></h:outputText>
					<h:selectOneMenu validatorMessage="required" id="priority"
						value="#{todo.priority}"
						binding="#{todoController.selectPriority}"
						rendered="#{todo.id == todoController.selectedId}">
						<f:selectItems value="#{todoController.priorities}" />
					</h:selectOneMenu>
				</h:column>
				<h:column>
					<f:facet name="header">
						<h:column>
							<h:outputText value="Title"></h:outputText>
						</h:column>
					</f:facet>
					<h:outputText value="#{todo.title}"
						binding="#{todoController.inputTitleOut}" for="title"
						rendered="#{todo.id != todoController.selectedId}"></h:outputText>
					<h:inputText value="#{todo.title}" required="true" id="title"
						requiredMessage="Title is required"
						binding="#{todoController.inputTitle}"
						rendered="#{todo.id == todoController.selectedId}">
					</h:inputText>

				</h:column>

				<h:column>
					<f:facet name="header">
						<h:column>
							<h:outputText value="Description"></h:outputText>
						</h:column>
					</f:facet>
					<h:outputText value="#{todo.description}"
						binding="#{todoController.textareaDescOut}" for="desc"
						rendered="#{todo.id != todoController.selectedId}"></h:outputText>
					<h:inputTextarea value="#{todo.description}" cols="20" id="desc"
						rows="1" binding="#{todoController.textareaDesc}"
						rendered="#{todo.id == todoController.selectedId}"></h:inputTextarea>
				</h:column>

				<h:column>
					<f:facet name="header">
						<h:column>
							<h:outputText value="Actions"></h:outputText>
						</h:column>
					</f:facet>
					<h:panelGrid columns="2">
						<p:commandButton value="delete"
						onclick="PF('dlg1').show();">
							<f:setPropertyActionListener target="#{todoController.todo}"
								value="#{todo}" />
						</p:commandButton>
					</h:panelGrid>
					<!-- start of edit -->
					<h:panelGrid columns="2">
						<h:commandButton id="update" value="Edit"
							action="#{todoController.edit}"
							binding="#{todoController.editTodo}">
							<f:setPropertyActionListener target="#{todoController.todo}"
								value="#{todo}" />
						</h:commandButton>
					</h:panelGrid>
					<!-- end of edit -->

					<!-- start of update -->
					<h:panelGrid columns="2">
						<h:commandButton id="btn_update" value="Update"
							action="#{todoController.update}"
							binding="#{todoController.updateTodo}"
							rendered="#{todo.id == todoController.selectedId}">
							<f:setPropertyActionListener target="#{todoController.todo}"
								value="#{todo}" />
						</h:commandButton>
					</h:panelGrid>
					<!-- end of update -->

					<!-- start of cancel update -->
					<h:panelGrid columns="2">
						<h:commandButton id="canecl" value="Cancel"
							action="#{todoController.updateCancel}"
							binding="#{todoController.cancelEdit}"
							rendered="#{todo.id == todoController.selectedId}">
							<f:setPropertyActionListener target="#{todoController.todo}"
								value="#{todo}" />
						</h:commandButton>
					</h:panelGrid>
					<!-- end of cancel update -->
				</h:column>
			</h:dataTable>
			
		</h:form>
		<p:dialog header="Do You Realy want to delete ?" widgetVar="dlg1"
				minHeight="40">
				<h:commandButton id="btn_dlg_yes" value="Delete"
					onclick="PF('dlg1').hide();"
					 actionListener="#{todoController.delete(todo)}">

				</h:commandButton>
				<h:commandButton id="btn_dlg_no" value="Cencel"
					onclick="PF('dlg1').hide();">
				</h:commandButton>
			</p:dialog>
	</f:view>
</h:body>
</html>